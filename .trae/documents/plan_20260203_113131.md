## 问题分析

用户反馈打印成功了，但样式与预期不一致。通过分析服务器端代码，我发现问题出在 `order.service.ts` 文件的 `generatePrintContent` 函数，该函数负责生成打印内容的格式。

## 修复方案

### 修改服务器端打印内容生成函数

需要修改 `c:\Users\wd439\Documents\trae_projects\ONTOP\apps\server\src\modules\order\order.service.ts` 文件中的 `generatePrintContent` 函数，调整以下内容：

1. **分隔线格式**：确保分隔线使用正确的长度和字符
2. **文本对齐**：调整 ON TOP、悦翔茶歇、订单号、时间等元素的对齐方式
3. **缩进设置**：使用适当的缩进量确保样式一致
4. **间距调整**：确保各元素之间的间距一致

### 具体修改内容

修改 `generatePrintContent` 函数，使其生成的打印内容与用户预期的样式一致：

```typescript
// 生成打印内容 - 按照用户详细要求的格式
private generatePrintContent(order: any): string {
  const items = order.items || [];
  const orderNo = order.order_no;
  const createdAt = new Date(order.created_at);
  const dateStr = new Date(order.created_at).toLocaleString('zh-CN', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit'
  });

  // 定义分隔线
  const divider = '========================';
  
  // 构建打印内容
  let content = '';
  content += '\n';
  content += `${divider}\n`;
  
  // ON TOP 和 悦翔茶歇，居中对齐
  const centerIndent = ' '.repeat(22);
  content += `${centerIndent}ON TOP\n`;
  content += `${centerIndent}悦翔茶歇\n`;
  content += `${divider}\n`;
  
  // 订单号: 左对齐，订单号值右对齐
  const orderNoIndent = ' '.repeat(18);
  content += `订单号: ${orderNoIndent}${orderNo}\n`;
  content += `${divider}\n`;
  
  // 商品明细
  content += `商品明细\n`;
  content += `${divider}\n`;
  
  // 打印商品列表
  items.forEach((item: any) => {
    const name = item.name || '未知商品';
    const quantity = item.quantity || 1;
    content += `${name}  X${quantity}\n`;
    
    if (item.specs && item.specs.text) {
      content += `温度: ${item.specs.text}\n`;
    }
  });
  
  content += `${divider}\n`;
  
  // 备注
  content += `备注:\n`;
  content += `${order.remark || '无'}\n`;
  content += `${divider}\n`;
  
  // 时间
  const timeIndent = ' '.repeat(16);
  content += `时间: ${timeIndent}${dateStr}\n`;
  content += '\n\n\n';
  
  return content;
}
```

## 实施步骤

1. **修改服务器端代码**：
   - 打开 `order.service.ts` 文件
   - 替换 `generatePrintContent` 函数的实现
   - 保存文件

2. **重新构建服务器**：
   - 在服务器目录下运行 `npm run build`
   - 重启服务器服务

3. **测试打印功能**：
   - 创建一个新的测试订单
   - 观察打印输出的样式
   - 确认样式与预期一致

4. **验证修复效果**：
   - 检查打印输出的格式
   - 确认所有元素对齐正确
   - 确认间距和缩进一致

## 预期效果

修改后，打印输出的样式应该与用户预期一致，包括：
- 正确的分隔线格式
- 居中对齐的标题
- 适当的缩进和间距
- 一致的文本对齐
- 完整的订单信息

这样，用户的打印机将输出格式美观、对齐正确的订单内容。